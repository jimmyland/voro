<!doctype html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Emscripten+voronoi test</title>
        <meta name="description" content="">
        <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1">
        <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
        <meta http-equiv="Pragma" content="no-cache" />
        <meta http-equiv="Expires" content="0" />
        <script type='text/javascript' src='js/jquery-2.2.2.min.js'></script>
        <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
        <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
        <script src="js/bootstrap-slider.min.js"></script>
        <link rel="stylesheet" href="js/bootstrap-slider.min.css">
        <script src="js/three.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/spectrum/1.8.0/spectrum.min.js"></script>
        <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/spectrum/1.8.0/spectrum.min.css">
        <script src="raycast_monkeypatch.js"></script>
        <script src="BufferGeometry_monkeypatch.js"></script>
        <script src="js/controls/TrackballControls.js"></script>
        <script src="js/controls/TransformControls.js"></script>
        <script src="js/Detector.js"></script>
        <script src="js/seedrandom.min.js"></script>
        <script src="js/FileSaver.min.js"></script>
        <script src="js/b64.js"></script>
        <link rel="stylesheet" href="styles/main.css">
    </head>
    <body>

    <!-- icons from the lovely Linearicons package on icomoon.io -->
        <svg style="position: absolute; width: 0; height: 0; overflow: hidden;" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
        <defs>
        <symbol id="icon-add" viewBox="0 0 20 20">
        <title>add</title>
        <path class="path1" d="M19.572 0.428c-0.28-0.28-0.655-0.421-1.117-0.421-0.753 0-1.765 0.394-3.021 1.174-0.402-0.425-1.167-1.077-2.131-1.155-0.769-0.062-1.495 0.241-2.157 0.903-1.405 1.405-2.097 3.121-2.555 4.256-0.156 0.386-0.349 0.866-0.445 0.965-0.033 0.033-0.132 0.132-0.304-0.013-0.196-0.185-0.505-0.181-0.696 0.010-0.195 0.195-0.195 0.512 0 0.707 0.082 0.082 0.293 0.241 0.562 0.316 0.108 0.030 0.216 0.045 0.322 0.045 0.127 0 0.251-0.022 0.369-0.065-0.137 0.141-0.274 0.282-0.411 0.425-3.517 3.673-7.46 8.713-7.982 11.842-0.027 0.159 0.025 0.322 0.14 0.436 0.095 0.095 0.222 0.146 0.354 0.146 0.027 0 0.055-0.002 0.082-0.007 1.308-0.218 3.032-1.046 5.125-2.46 1.852-1.251 3.906-2.908 5.94-4.791 1.984-1.837 3.794-3.742 5.235-5.511 1.076-1.321 2.458-3.208 2.934-4.692 0.301-0.939 0.219-1.649-0.244-2.112zM11.854 1.635c0.45-0.45 0.896-0.651 1.365-0.614 0.561 0.044 1.053 0.418 1.365 0.72-0.247 0.172-0.501 0.355-0.763 0.552-1.424 1.069-3.040 2.488-4.65 4.081 0.107-0.218 0.216-0.488 0.349-0.816 0.427-1.060 1.073-2.662 2.334-3.923zM3.036 15.243l1.722 1.722c-1.365 0.892-2.584 1.526-3.57 1.847 0.322-0.987 0.958-2.206 1.848-3.569zM10.969 12.009c-1.876 1.736-3.71 3.228-5.367 4.386l-1.995-1.995c1.321-1.892 3.071-4.008 5.105-6.132 2.362-2.467 4.695-4.505 6.562-5.787l2.244 2.244c-1.431 2.086-3.786 4.726-6.549 7.284zM18.864 2.235c-0.148 0.462-0.418 1.013-0.791 1.631l-1.941-1.941c0.978-0.591 1.78-0.918 2.324-0.918 0.281 0 0.378 0.097 0.41 0.128 0.232 0.232 0.099 0.789-0.001 1.1z"></path>
        </symbol>
        <symbol id="icon-delete" viewBox="0 0 20 20">
        <title>delete</title>
        <path class="path1" d="M19.715 6.913c-0.026-0.155-0.077-0.305-0.155-0.446-0.114-0.209-0.276-0.38-0.472-0.506-0.002-0.001-0.003-0.002-0.005-0.003-0.010-0.007-0.021-0.013-0.032-0.020-0.096-0.059-0.205-0.108-0.327-0.145-0.024-0.007-0.049-0.014-0.074-0.021l-6.060-1.515c-0.162-0.040-0.34-0.061-0.53-0.061-0.599 0-1.25 0.205-1.658 0.523l-7.421 5.772c-0.51 0.396-1.069 1.187-1.273 1.799l-1.368 4.103c-0.129 0.386-0.094 0.791 0.098 1.14s0.515 0.596 0.909 0.694l6.060 1.515c0.162 0.040 0.34 0.061 0.53 0.061 0.474 0 0.981-0.129 1.374-0.341 0.091-0.046 0.186-0.106 0.284-0.182l7.421-5.772c0.51-0.396 1.069-1.187 1.273-1.799l1.368-4.103c0.092-0.275 0.111-0.504 0.057-0.694zM12.062 5.197c0.107 0 0.206 0.011 0.287 0.031l6.033 1.508-7.4 5.755c-0.236 0.184-0.666 0.312-1.044 0.312-0.107 0-0.206-0.011-0.287-0.031l-6.033-1.508 7.4-5.755c0.236-0.184 0.666-0.312 1.044-0.312zM1.316 17.052c-0.056-0.102-0.065-0.224-0.026-0.343l1.368-4.103c0.092-0.276 0.408-0.45 0.691-0.379 0 0 0 0 0 0l6.060 1.515c0.121 0.030 0.219 0.103 0.275 0.205s0.065 0.224 0.026 0.343l-1.368 4.103c-0.092 0.276-0.409 0.45-0.691 0.379l-1.030-0.257c-0 0-0-0-0-0l-5.030-1.257c-0.121-0.030-0.219-0.103-0.275-0.206zM16.404 12.719l-6.907 5.372 1.162-3.485c0.143-0.429 0.581-1.049 0.938-1.326l6.907-5.372-1.162 3.485c-0.143 0.429-0.581 1.048-0.938 1.326z"></path>
        </symbol>
        <symbol id="icon-show" viewBox="0 0 20 20">
        <title>show</title>
        <path class="path1" d="M19.872 9.166c-0.047-0.053-1.182-1.305-2.956-2.572-1.047-0.748-2.1-1.344-3.13-1.773-0.264-0.11-0.526-0.208-0.787-0.296-0.019-0.008-0.038-0.014-0.057-0.019-1.010-0.335-1.997-0.505-2.942-0.505s-1.932 0.17-2.943 0.505c-0.019 0.005-0.038 0.011-0.057 0.019-0.261 0.088-0.523 0.186-0.787 0.296-1.030 0.429-2.083 1.026-3.13 1.773-1.774 1.267-2.909 2.52-2.956 2.572-0.171 0.19-0.171 0.479 0 0.669 0.044 0.049 1.105 1.22 2.778 2.444 0.986 0.721 1.982 1.31 2.958 1.751 1.237 0.558 2.449 0.878 3.603 0.954 0.011 0.001 0.022 0.001 0.033 0.001 0.261 0 0.481-0.203 0.498-0.468 0.018-0.276-0.191-0.513-0.466-0.531-2.351-0.153-4.57-1.445-6.019-2.501-1.074-0.783-1.895-1.558-2.32-1.984 0.447-0.448 1.332-1.281 2.489-2.106 0.53-0.378 1.156-0.78 1.85-1.145-0.347 0.688-0.533 1.455-0.533 2.251 0 1.239 0.456 2.427 1.285 3.346 0.822 0.912 1.945 1.489 3.16 1.623 0.019 0.002 0.037 0.003 0.056 0.003 0.252 0 0.468-0.189 0.496-0.445 0.030-0.274-0.168-0.522-0.442-0.552-2.027-0.224-3.555-1.933-3.555-3.976 0-1.188 0.519-2.299 1.426-3.062 0.822-0.268 1.691-0.438 2.574-0.438s1.752 0.17 2.574 0.438c0.907 0.763 1.426 1.873 1.426 3.062 0 0.3-0.033 0.6-0.099 0.889-0.061 0.269 0.108 0.537 0.377 0.598 0.037 0.008 0.074 0.012 0.111 0.012 0.228 0 0.434-0.157 0.487-0.389 0.082-0.362 0.124-0.736 0.124-1.111 0-0.796-0.186-1.563-0.533-2.251 0.694 0.365 1.32 0.768 1.85 1.145 1.157 0.825 2.043 1.658 2.49 2.106-0.161 0.161-0.378 0.372-0.643 0.613-0.204 0.186-0.219 0.502-0.033 0.706s0.502 0.219 0.706 0.033c0.647-0.589 1.020-1.001 1.035-1.019 0.171-0.19 0.171-0.479-0-0.669z"></path>
        <path class="path2" d="M17.5 15h-1.5v-1.5c0-0.276-0.224-0.5-0.5-0.5s-0.5 0.224-0.5 0.5v1.5h-1.5c-0.276 0-0.5 0.224-0.5 0.5s0.224 0.5 0.5 0.5h1.5v1.5c0 0.276 0.224 0.5 0.5 0.5s0.5-0.224 0.5-0.5v-1.5h1.5c0.276 0 0.5-0.224 0.5-0.5s-0.224-0.5-0.5-0.5z"></path>
        <path class="path3" d="M15.5 20c-2.481 0-4.5-2.019-4.5-4.5s2.019-4.5 4.5-4.5 4.5 2.019 4.5 4.5-2.019 4.5-4.5 4.5zM15.5 12c-1.93 0-3.5 1.57-3.5 3.5s1.57 3.5 3.5 3.5 3.5-1.57 3.5-3.5-1.57-3.5-3.5-3.5z"></path>
        </symbol>
        <symbol id="icon-hide" viewBox="0 0 20 20">
        <title>hide</title>
        <path class="path1" d="M19.872 9.166c-0.047-0.053-1.182-1.305-2.956-2.572-1.047-0.748-2.1-1.344-3.13-1.773-0.264-0.11-0.526-0.208-0.787-0.296-0.019-0.008-0.038-0.014-0.057-0.019-1.010-0.335-1.997-0.505-2.942-0.505s-1.932 0.17-2.943 0.505c-0.019 0.005-0.038 0.011-0.057 0.019-0.261 0.088-0.523 0.186-0.787 0.296-1.030 0.429-2.083 1.026-3.13 1.773-1.774 1.267-2.909 2.52-2.956 2.572-0.171 0.19-0.171 0.479 0 0.669 0.044 0.049 1.105 1.22 2.778 2.444 0.986 0.721 1.982 1.31 2.958 1.751 1.237 0.558 2.449 0.878 3.603 0.954 0.011 0.001 0.022 0.001 0.033 0.001 0.261 0 0.481-0.203 0.498-0.468 0.018-0.276-0.191-0.513-0.466-0.531-2.351-0.153-4.57-1.445-6.019-2.501-1.074-0.783-1.895-1.558-2.32-1.984 0.447-0.448 1.332-1.281 2.489-2.106 0.53-0.378 1.156-0.78 1.85-1.145-0.347 0.688-0.533 1.455-0.533 2.251 0 1.239 0.456 2.427 1.285 3.346 0.822 0.912 1.945 1.489 3.16 1.623 0.019 0.002 0.037 0.003 0.056 0.003 0.252 0 0.468-0.189 0.496-0.445 0.030-0.274-0.168-0.522-0.442-0.552-2.027-0.224-3.555-1.933-3.555-3.976 0-1.188 0.519-2.299 1.426-3.062 0.822-0.268 1.691-0.438 2.574-0.438s1.752 0.17 2.574 0.438c0.907 0.763 1.426 1.873 1.426 3.062 0 0.3-0.033 0.6-0.099 0.889-0.061 0.269 0.108 0.537 0.377 0.598 0.037 0.008 0.074 0.012 0.111 0.012 0.228 0 0.434-0.157 0.487-0.389 0.082-0.362 0.124-0.736 0.124-1.111 0-0.796-0.186-1.563-0.533-2.251 0.694 0.365 1.32 0.768 1.85 1.145 1.157 0.825 2.043 1.658 2.49 2.106-0.161 0.161-0.378 0.372-0.643 0.613-0.204 0.186-0.219 0.502-0.033 0.706s0.502 0.219 0.706 0.033c0.647-0.589 1.020-1.001 1.035-1.019 0.171-0.19 0.171-0.479-0-0.669z"></path>
        <path class="path2" d="M17.5 16h-4c-0.276 0-0.5-0.224-0.5-0.5s0.224-0.5 0.5-0.5h4c0.276 0 0.5 0.224 0.5 0.5s-0.224 0.5-0.5 0.5z"></path>
        <path class="path3" d="M15.5 20c-2.481 0-4.5-2.019-4.5-4.5s2.019-4.5 4.5-4.5 4.5 2.019 4.5 4.5-2.019 4.5-4.5 4.5zM15.5 12c-1.93 0-3.5 1.57-3.5 3.5s1.57 3.5 3.5 3.5 3.5-1.57 3.5-3.5-1.57-3.5-3.5-3.5z"></path>
        </symbol>
        <symbol id="icon-select" viewBox="0 0 20 20">
        <title>select</title>
        <path class="path1" d="M5.5 15h-4c-0.827 0-1.5-0.673-1.5-1.5v-12c0-0.827 0.673-1.5 1.5-1.5h14c0.827 0 1.5 0.673 1.5 1.5v7c0 0.276-0.224 0.5-0.5 0.5s-0.5-0.224-0.5-0.5v-7c0-0.276-0.224-0.5-0.5-0.5h-14c-0.276 0-0.5 0.224-0.5 0.5v12c0 0.276 0.224 0.5 0.5 0.5h4c0.276 0 0.5 0.224 0.5 0.5s-0.224 0.5-0.5 0.5z"></path>
        <path class="path2" d="M13 20c-0.198 0-0.386-0.119-0.464-0.314l-1.697-4.242-2.963 3.386c-0.137 0.157-0.357 0.212-0.552 0.139s-0.324-0.26-0.324-0.468v-15c0-0.198 0.117-0.377 0.298-0.457s0.392-0.046 0.539 0.087l11 10c0.153 0.139 0.205 0.358 0.13 0.55s-0.26 0.32-0.466 0.32h-4.261l1.726 4.314c0.103 0.256-0.022 0.547-0.279 0.65l-2.5 1c-0.061 0.024-0.124 0.036-0.186 0.036zM11 14c0.028 0 0.056 0.002 0.084 0.007 0.172 0.029 0.315 0.146 0.38 0.307l1.814 4.536 1.572-0.629-1.814-4.536c-0.062-0.154-0.043-0.329 0.050-0.466s0.248-0.22 0.414-0.22h3.707l-9.207-8.37v12.539l2.624-2.999c0.096-0.109 0.233-0.171 0.376-0.171z"></path>
        </symbol>
        <symbol id="icon-select-neighbor" viewBox="0 0 20 20">
        <title>select-neighbor</title>
        <path class="path1" d="M16 7h1v1h-1v-1z"></path>
        <path class="path2" d="M16 19h1v1h-1v-1z"></path>
        <path class="path3" d="M14 19h1v1h-1v-1z"></path>
        <path class="path4" d="M12 19h1v1h-1v-1z"></path>
        <path class="path5" d="M10 19h1v1h-1v-1z"></path>
        <path class="path6" d="M8 19h1v1h-1v-1z"></path>
        <path class="path7" d="M18 15h1v1h-1v-1z"></path>
        <path class="path8" d="M18 13h1v1h-1v-1z"></path>
        <path class="path9" d="M18 17h1v1h-1v-1z"></path>
        <path class="path10" d="M18 9h1v1h-1v-1z"></path>
        <path class="path11" d="M18 11h1v1h-1v-1z"></path>
        <path class="path12" d="M6 17h1v1h-1v-1z"></path>
        <path class="path13" d="M14 7h1v1h-1v-1z"></path>
        <path class="path14" d="M11.5 1h-10c-0.827 0-1.5 0.673-1.5 1.5v10c0 0.827 0.673 1.5 1.5 1.5h5.5v-5.5c0-0.276 0.224-0.5 0.5-0.5h5.5v-5.5c0-0.827-0.673-1.5-1.5-1.5zM7.5 7c-0.827 0-1.5 0.673-1.5 1.5v4.5h-4.5c-0.276 0-0.5-0.224-0.5-0.5v-10c0-0.276 0.224-0.5 0.5-0.5h10c0.276 0 0.5 0.224 0.5 0.5v4.5h-4.5z"></path>
        <path class="path15" d="M6 15h1v1h-1v-1z"></path>
        <path class="path16" d="M18 7h1v1h-1v-1z"></path>
        <path class="path17" d="M18 19h1v1h-1v-1z"></path>
        <path class="path18" d="M6 19h1v1h-1v-1z"></path>
        </symbol>
        <symbol id="icon-brush" viewBox="0 0 20 20">
        <title>brush2</title>
        <path class="path1" d="M3.5 17c-0.132 0-0.261-0.053-0.353-0.147s-0.147-0.222-0.147-0.353 0.053-0.26 0.147-0.353c0.093-0.093 0.222-0.147 0.353-0.147s0.26 0.053 0.353 0.147c0.093 0.093 0.147 0.222 0.147 0.353s-0.053 0.261-0.147 0.353c-0.093 0.093-0.222 0.147-0.353 0.147z"></path>
        <path class="path2" d="M18.646 9.439l-8.086-8.086c-0.283-0.283-0.659-0.438-1.061-0.438s-0.778 0.156-1.061 0.438l-5.086 5.086c-0.539 0.539-0.695 1.496-0.354 2.179l1.606 3.211c0.049 0.099 0.058 0.193 0.024 0.265s-0.111 0.127-0.219 0.152c-0.086 0.021-2.129 0.521-3.386 1.778-0.661 0.661-1.025 1.54-1.025 2.475s0.364 1.814 1.025 2.475c0.661 0.661 1.54 1.025 2.475 1.025 0 0-0 0 0 0 0.935 0 1.814-0.364 2.475-1.025 1.257-1.257 1.758-3.3 1.778-3.386 0.021-0.089 0.082-0.239 0.249-0.239 0.053 0 0.11 0.015 0.169 0.045l3.211 1.606c0.238 0.119 0.517 0.182 0.808 0.182 0.523 0 1.035-0.2 1.37-0.535l5.086-5.086c0.585-0.585 0.585-1.536 0-2.121zM12.854 15.939c-0.147 0.147-0.408 0.242-0.663 0.242-0.137 0-0.262-0.026-0.361-0.076l-3.211-1.606c-0.199-0.1-0.407-0.15-0.616-0.15-0.586 0-1.077 0.404-1.221 1.006-0.004 0.018-0.458 1.858-1.513 2.912-0.472 0.472-1.1 0.732-1.768 0.732s-1.296-0.26-1.768-0.732c-0.472-0.472-0.732-1.1-0.732-1.768s0.26-1.296 0.732-1.768c1.055-1.055 2.894-1.509 2.912-1.513 0.404-0.097 0.729-0.353 0.892-0.702s0.15-0.763-0.036-1.135l-1.606-3.211c-0.15-0.299-0.070-0.788 0.166-1.024l0.939-0.939 8.793 8.793-0.939 0.939zM17.939 10.854l-3.439 3.439-8.793-8.793 3.439-3.439c0.094-0.094 0.219-0.145 0.354-0.145s0.26 0.052 0.354 0.145l8.086 8.086c0.195 0.195 0.195 0.512 0 0.707z"></path>
        </symbol>
        <symbol id="icon-palette" viewBox="0 0 20 20">
        <title>palette</title>
        <path class="path1" d="M6.5 8c-0.827 0-1.5-0.673-1.5-1.5s0.673-1.5 1.5-1.5 1.5 0.673 1.5 1.5-0.673 1.5-1.5 1.5zM6.5 6c-0.276 0-0.5 0.224-0.5 0.5s0.224 0.5 0.5 0.5 0.5-0.224 0.5-0.5-0.224-0.5-0.5-0.5z"></path>
        <path class="path2" d="M3.5 11c-0.827 0-1.5-0.673-1.5-1.5s0.673-1.5 1.5-1.5 1.5 0.673 1.5 1.5c0 0.827-0.673 1.5-1.5 1.5zM3.5 9c-0.276 0-0.5 0.224-0.5 0.5s0.224 0.5 0.5 0.5 0.5-0.224 0.5-0.5-0.224-0.5-0.5-0.5z"></path>
        <path class="path3" d="M10.5 7c-0.827 0-1.5-0.673-1.5-1.5s0.673-1.5 1.5-1.5c0.827 0 1.5 0.673 1.5 1.5s-0.673 1.5-1.5 1.5zM10.5 5c-0.276 0-0.5 0.224-0.5 0.5s0.224 0.5 0.5 0.5 0.5-0.224 0.5-0.5-0.224-0.5-0.5-0.5z"></path>
        <path class="path4" d="M10 19c-2.655 0-5.155-0.874-7.040-2.461-0.925-0.779-1.652-1.687-2.161-2.701-0.531-1.057-0.8-2.18-0.8-3.338s0.269-2.282 0.8-3.338c0.509-1.014 1.236-1.922 2.161-2.701 1.884-1.587 4.384-2.461 7.040-2.461s5.155 0.874 7.040 2.461c0.925 0.779 1.652 1.687 2.161 2.701 0.531 1.057 0.8 2.18 0.8 3.338 0 1.852-0.825 2.512-1.597 2.512-0.645 0-1.309-0.452-1.822-1.239-0.324-0.497-0.666-0.771-0.963-0.771-0.099 0-0.197 0.030-0.299 0.091-0.562 0.336-0.23 1.245 0.018 1.756 0.802 1.654 0.868 3.098 0.192 4.178-0.82 1.31-2.681 1.974-5.53 1.974zM10 3c-4.963 0-9 3.364-9 7.5s4.037 7.5 9 7.5c1.366 0 2.474-0.159 3.293-0.473 0.649-0.249 1.117-0.596 1.39-1.032 0.611-0.976 0.204-2.284-0.245-3.21-0.96-1.98-0.063-2.793 0.368-3.051 0.258-0.154 0.531-0.233 0.813-0.233 0.458 0 1.142 0.213 1.801 1.226 0.377 0.579 0.766 0.785 0.984 0.785 0.357 0 0.597-0.608 0.597-1.512 0-4.136-4.037-7.5-9-7.5z"></path>
        <path class="path5" d="M11 16c-1.103 0-2-0.897-2-2s0.897-2 2-2c1.103 0 2 0.897 2 2s-0.897 2-2 2zM11 13c-0.551 0-1 0.449-1 1s0.449 1 1 1 1-0.449 1-1-0.449-1-1-1z"></path>
        </symbol>
        </defs>
        </svg>
        
        <script type="x-shader/x-vertex" id="sites_vertshader">
        attribute float size;
        uniform float scale;
        varying float alpha;

        void main() {
            vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
            gl_PointSize = scale * size * ( 10.0 / -mvPosition.z );
            gl_Position = projectionMatrix * mvPosition;
            alpha = clamp(size, 0.0, 1.0);
        }
        </script>
        
        <script type="x-shader/x-fragment" id="sites_fragshader">
        uniform vec3 color;
        varying float alpha;

        void main() {
            gl_FragColor = vec4(color, alpha);
        }
        </script>

        <input type="file" id="upload_raw" accept=".vor" style="position: fixed; top: -100em">
        <script>var ready_for_emscripten_calls = false;</script>
        <div id="container" tabindex="0" class="no-selection" style="outline: 0px solid transparent;"></div>
        <script type="text/javascript" src="vorowrap.js"></script>
        <script type="text/javascript" src="voro3.js"></script>
        <script type="text/javascript" src="main.js"></script>


        <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="myModalLabel">Placeholder modal</h4>
              </div>
              <div class="modal-body">
                ...
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Save changes</button>
              </div>
            </div>
          </div>
        </div>

        <div class="modal fade" id="saveModal" tabindex="-1" role="dialog" aria-labelledby="saveModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="saveModalLabel">Save to Disk</h4>
              </div>
              <div class="modal-body">
              <form class="form-inline" id="saveForm" onsubmit="$('#saveModal').modal('hide'); return doSave();">
              <div class="form-inline">
                <label>Filename:</label>
                <input type="text" class="form-control" id="file" value="untitled" name="file">
              </div>

              </form>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="doSave();">Save</button>
              </div>
              <script>function doSave() { settings.filename = getFormVals('#saveForm').file; settings.downloadRaw(); return false; } </script>
            </div>
          </div>
        </div>

        <div class="modal fade" id="exportModal" tabindex="-1" role="dialog" aria-labelledby="exportModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="exportModalLabel">Save to Disk</h4>
              </div>
              <div class="modal-body">
              <form class="form-inline" id="exportForm" onsubmit="$('#exportModal').modal('hide'); doExport(); return false;">
              <div class="form-inline">
                <label>Filename:</label>
                <input type="text" class="form-control" id="file" value="untitled" name="file">
              </div>
              </form>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="doExport();">Export</button>
              </div>
              <script>function doExport() { settings.filename = getFormVals('#exportForm').file; settings.exportAsSTL(); }</script>
            </div>
          </div>
        </div>

        <div class="modal fade" id="showSitesModal" tabindex="-1" role="dialog" aria-labelledby="showSitesModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="showSitesModalLabel">Voronoi Site Visualization Settings</h4>
              </div>
              <div class="modal-body">
              <form class="form-inline" id="showSitesForm">
              <div class="checkbox">
                <label><input type="checkbox" name="show" checked>&nbsp;Show Sites</label>
              </div>
              <div class="form-inline">
                <label for="sites_scale">Scale:</label>
                <input id="sites_scale_slider" type="text" name="sites_scale" data-slider-value="1" data-slider-min=".1" data-slider-max="10" data-slider-step="1" />
                &nbsp;&nbsp;&nbsp;<span id="sites_scale_slider_val">1</span>
                <script type="text/javascript">$("#sites_scale_slider").slider({
                    min: .1,
                    max: 20,
                    value: 1,
                    step: .1
                });
                $("#sites_scale_slider").on("slide", function(slideEvt) {
                    $("#sites_scale_slider_val").text(slideEvt.value);
                });
                </script>
              </div>
              </form>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="settings.set_sites_from_form(getFormVals('#showSitesForm'));">Apply</button>
              </div>
            </div>
          </div>
        </div>

        <div class="modal fade" id="symmetryModal" tabindex="-1" role="dialog" aria-labelledby="symmetryModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="symmetryModalLabel">Symmetry</h4>
              </div>
              <div class="modal-body">
              <form class="form-inline" id="symmetryForm">
              <label for="genfun">Symmetry Type:</label><select class="form-control" id="symfun" name="symmetry_mode">
                <option>Mirror</option>
                <option>Rotational</option>
                <option>Dihedral</option>
              </select>
              <div class="form-inline">
                <label for="sym_param" id="sym_param_name">Symmetry Parameter:</label>
                <input id="sym_param_slider" type="text" name="sym_param" data-slider-value="3" data-slider-min="2" data-slider-max="10" data-slider-step="1" />
                &nbsp;&nbsp;&nbsp;<span id="sym_param_slider_val">3</span>
                <script type="text/javascript">$("#sym_param_slider").slider({
                    min: 2,
                    max: 10,
                    value: 3,
                    step: 1
                });
                $("#sym_param_slider").on("slide", function(slideEvt) {
                    $("#sym_param_slider_val").text(slideEvt.value);
                });
                </script>
              </div>
              </form>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="settings.symmetrify_from_form(getFormVals('#symmetryForm'));">Apply</button>
              </div>
            </div>
          </div>
        </div>

        <div class="modal fade" id="generateModal" tabindex="-1" role="dialog" aria-labelledby="generateModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="generateModalLabel">Create New Voronoi Diagram</h4>
              </div>
              <div class="modal-body">
              <form class="form-inline" id="generatorForm">
              <label for="genfun">Initial Voronoi Site Placement:</label><select class="form-control" id="genfun" name="generator">
                <option>Random</option>
                <option>Cubes</option>
                <option>Gyrobifastigia</option>
                <option>Rhombic Dodecahedra</option>
                <option>Elongated Dodecahedra</option>
                <option>Truncated Octahedra</option>
                <option>Hexagonal Prisms</option>
                <option>Triangular Prisms</option>
                <option>Cubes with Pillows</option>
              </select>
              <div class="form-inline">
                <label for="numpts_slider">Approx. Desired Number of Sites:</label>
                <input id="numpts_slider" type="text" name="numpts" data-slider-value="1000" data-slider-min="1" data-slider-max="10000000" data-slider-step="1" />
                &nbsp;&nbsp;&nbsp;<span id="numpts_slider_label_val">1000</span>
                <script type="text/javascript">$("#numpts_slider").slider({
                    min: 1,
                    max: 1000000,
                    value: 1000,
                    scale: 'logarithmic',
                    step: 1
                });
                $("#numpts_slider").on("slide", function(slideEvt) {
                    $("#numpts_slider_label_val").text(slideEvt.value);
                });
                </script>
              </div>
              <div class="form-inline">
                <label for="seed">Random Number Generator's Seed:</label>
                <input type="text" class="form-control" id="seed" value="This controls the RNG" name="seed">
              </div>
              </form>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="settings.generate_from_form(getFormVals('#generatorForm'));">Create</button>
              </div>
            </div>
          </div>
        </div>
        <script>$('#generateModal').modal('show');</script>


        <div id="icons" style="color:#000; font-size: 32px; fill: #ff0000; background: #000; position: absolute; top: 0px; padding: 0px;">
            <div class="dropdown" style="display: inline-block; padding: 0px;">
              <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">File
              <span class="caret"></span></button>
              <ul class="dropdown-menu">
                <li><a role="button" href="#generateModal" data-toggle="modal" data-target="#generateModal">New ...</a></li>
                <li><a role="button" onclick="settings.uploadRaw();">Load ...</a></li>
                <li><a role="button" href="#saveModal" data-toggle="modal" data-target="#saveModal">Save ...</a></li>
                <li><a role="button" href="#exportModal" data-toggle="modal" data-target="#exportModal">Export STL ...</a></li>
              </ul>
            </div><div class="dropdown" style="display: inline-block; padding: 0px;">
              <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">Edit
              <span class="caret"></span></button>
              <ul class="dropdown-menu">
                <li><a role="button" onclick="undo_q.undo();">Undo</a></li>
                <li><a role="button" onclick="undo_q.redo();">Redo</a></li>
                <li><a role="button" href="#symmetryModal" data-toggle="modal" data-target="#symmetryModal">Enable Symmetry ...</a></li>
                <li><a role="button" onclick="settings.bake_symmetry()">Bake and Disable Symmetry</a></li>
              </ul>
            </div><div class="dropdown" style="display: inline-block; padding: 0px;">
              <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">View
              <span class="caret"></span></button>
              <ul class="dropdown-menu">
                <li><a role="button" href="#myModal" data-toggle="modal" data-target="#showSitesModal">Visualize Sites ...</a></li>
              </ul>
            </div>
        </div>
        <div id="icons" style="color:#000; font-size: 32px; fill: #ff0000; background: #000; position: absolute; top: 50px; padding: 0px;">
            <div class="btn-group-vertical" style="margin: 0px; padding: 0px;">
              <button type="button" title="select and move cells" class="btn btn-primary active" onclick="settings.mode = 'move';">
              <svg class="icon" style="color:#FFFFFF; font-size: 32px;"><use xlink:href="#icon-select"></use></svg>
              </button>
              <button type="button" title="select and move cell neighbors" class="btn btn-primary" onclick="settings.mode = 'move neighbor';">
              <svg class="icon" style="color:#FFFFFF; font-size: 32px;"><use xlink:href="#icon-select-neighbor"></use></svg>
              </button>
              <button type="button" title="show cells" class="btn btn-primary" onclick="settings.mode = 'toggle';">
              <svg class="icon" style="color:#FFFFFF; font-size: 32px;"><use xlink:href="#icon-show"></use></svg>
              </button>
              <button type="button" title="hide cells" class="btn btn-primary" onclick="settings.mode = 'toggle off';">
              <svg class="icon" style="color:#FFFFFF; font-size: 32px;"><use xlink:href="#icon-hide"></use></svg>
              </button>
              <button type="button" title="add cells" class="btn btn-primary" onclick="settings.mode = 'add/delete';">
              <svg class="icon" style="color:#FFFFFF; font-size: 32px;"><use xlink:href="#icon-add"></use></svg>
              </button>
              <button type="button" title="delete cells" class="btn btn-primary" onclick="settings.mode = 'delete';">
              <svg class="icon" style="color:#FFFFFF; font-size: 32px;"><use xlink:href="#icon-delete"></use></svg>
              </button>
              <button type="button" title="brush" class="btn btn-primary" onclick="settings.mode = 'brush';">
              <svg class="icon" style="color:#FFFFFF; font-size: 32px;"><use xlink:href="#icon-brush"></use></svg>
              </button>
            </div>
            <div id="palette" style="color:#fff; font-size: 24px; fill: #ff0000; background: #000;">
            <svg class="icon" style="color:#FFFFFF; font-size: 24px;"><use xlink:href="#icon-palette"></use></svg>: <input type='text' id="showPalette"/>
            <script type="text/javascript">
                function getTypeFromUIPalette() {
                    var pal = $("#showPalette").spectrum("option", "palette");
                    var cur = $("#showPalette").spectrum("get");
                    var type = 1;
                    for (var outer=0; outer<pal.length; outer++) {
                        for (var inner=0; inner<pal[outer].length; inner++) {
                            console.log(cur+" vs "+pal[outer][inner]);
                            if (cur == pal[outer][inner]) {
                                return type;
                            }
                            type++;
                        }
                    }
                    console.log("not found");
                    return 1;
                }
                $("#showPalette").spectrum({
                    change: function(color) {
                        v3.active_type = getTypeFromUIPalette();
                    },
                    preferredFormat: "hex",
                    showPaletteOnly: true,
                    showPalette: true,
                    color: '#ffffff',
                    palette: [
['#ffffff', '#efff9c', '#9fdbc7', '#fb7d7d', '#ffb69d'], //beach http://www.color-hex.com/color-palette/22804
['#f29cfd', '#aae8ff', '#c2ffe5', '#d3cecd', '#fff4d6'], //pastels http://www.color-hex.com/color-palette/22703
['#fffea1', '#ffff5d', '#eac071', '#df9a53', '#df6f21'], //sunny rocks http://www.color-hex.com/color-palette/22910
['#cbffd0', '#8febbc', '#93d4b8', '#a38a64', '#7b5a33'], //mint choco chip http://www.color-hex.com/color-palette/22829
['#b3cde0', '#6497b1', '#005b96', '#03396c', '#011f4b'], //blues http://www.color-hex.com/color-palette/1294
['#32bd07', '#c7c136', '#d22828', '#9a4962', '#1ebbea'], //apple logo colors http://www.color-hex.com/color-palette/22943
['#722525', '#ab5813', '#a5825e', '#48541c', '#582f14'], //autumn http://www.color-hex.com/color-palette/22655 
['#383838', '#2d5867', '#1e2e4d', '#000d11', '#2c003a']  //night time http://www.color-hex.com/color-palette/1167  
                    ]
                });
            </script>
        </div>
        </div>
        
        <script>
            function getFormVals(id) {
                var values = {};
                $.each($(id).serializeArray(), function(i, field) {
                    values[field.name] = field.value;
                }); 
                return values;
            }
            $(".btn-group-vertical > .btn").click(function(){
                $(".btn-group-vertical > .btn").removeClass("active");
                $(this).addClass("active");
            });
            $( document ).ready(function() {      
                var isMobile = window.matchMedia("only screen and (max-width: 760px)");

                if (isMobile.matches) {
                    $('#notmobile_instrutions').html('');
                }
             });
        </script>
    </body>
</html>
